<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MALL APP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --black:#0b0b0b;
  --yellow:#f5c400;
  --gray:#f3f3f3;
}
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:var(--gray);padding-bottom:70px}
header{background:var(--black);color:#fff;padding:14px;text-align:center;font-weight:bold}
.page{display:none;padding:15px}
.page.active{display:block}
.card{
  background:#fff;padding:15px;border-radius:14px;
  margin-bottom:15px;box-shadow:0 4px 10px rgba(0,0,0,.08)
}
input,select,button{
  width:100%;padding:10px;margin-top:8px;
  border-radius:8px;border:1px solid #ccc
}
button{border:none;font-weight:bold;cursor:pointer}
.primary{background:var(--yellow)}
.primary:disabled{opacity:.5}
.outline{background:#fff;border:2px solid var(--yellow)}
.bottom-nav{
  position:fixed;bottom:0;left:0;right:0;
  background:#fff;border-top:1px solid #ddd;
  display:flex;justify-content:space-around;padding:8px 0
}
.bottom-nav button{background:none;border:none;font-size:12px}
.bottom-nav button.active{color:var(--yellow);font-weight:bold}
img{max-width:100%;border-radius:8px;margin-top:5px}
</style>
</head>

<body>

<header>MALL</header>

<!-- HOME -->
<div id="home" class="page active">
  <div class="card">
    <input placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬">
  </div>
</div>

<!-- STORE -->
<div id="stores" class="page">
  <h3>ğŸª Ø§Ù„Ù…ØªØ¬Ø±</h3>

  <div class="card">
    <h4>ğŸ§¥ Ù…Ù„Ø§Ø¨Ø³</h4>
    <button class="primary" onclick="openStore('Ù…Ù„Ø§Ø¨Ø³')">Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
  </div>

  <div class="card">
    <h4>ğŸ’» Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</h4>
    <button class="primary" onclick="openStore('Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª')">Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
  </div>
</div>

<!-- PRODUCTS -->
<div id="products" class="page">
  <h3 id="storeName"></h3>

  <!-- ADD PRODUCT -->
  <div id="addProductBox" class="card">
    <h4>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h4>

    <input id="p_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
    <input id="p_price" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">

    <select id="p_currency">
      <option value="MAD">Ø¯Ø±Ù‡Ù… (MAD)</option>
      <option value="USD">Ø¯ÙˆÙ„Ø§Ø± (USD)</option>
      <option value="EUR">ÙŠÙˆØ±Ùˆ (EUR)</option>
    </select>

    <!-- Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© -->
    <input id="p_stock" type="number" min="1" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©">

    <!-- Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ± -->
    <input id="p_images" type="file" multiple accept="image/*">

    <button class="primary" onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
  </div>

  <div id="productList"></div>
</div>

<!-- CART -->
<div id="cart" class="page">
  <h3>ğŸ›’ Ø§Ù„Ø³Ù„Ø©</h3>
  <div id="cartItems"></div>
  <h4 id="total"></h4>
</div>

<!-- NAV -->
<div class="bottom-nav">
  <button class="active" onclick="showPage('home',this)">ğŸ <br>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
  <button onclick="showPage('stores',this)">ğŸª<br>Ø§Ù„Ù…ØªØ¬Ø±</button>
  <button onclick="showPage('cart',this)">ğŸ›’<br>Ø§Ù„Ø³Ù„Ø©</button>
</div>

<script>
/* NAV */
function showPage(id,btn){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.bottom-nav button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

/* DATA */
let currentCategory="";
let products = JSON.parse(localStorage.getItem("products")) || [];
let cart = JSON.parse(localStorage.getItem("cart")) || [];

/* OPEN STORE */
function openStore(cat){
  currentCategory = cat;
  storeName.innerText = "Ù…Ù†ØªØ¬Ø§Øª " + cat;
  showPage('products', document.querySelector(".bottom-nav button:nth-child(2)"));
  renderProducts();
}

/* ADD PRODUCT */
function addProduct(){
  if(!p_name.value || !p_price.value || !p_stock.value){
    alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
    return;
  }

  const images = [];
  for(let file of p_images.files){
    images.push(URL.createObjectURL(file));
  }

  products.push({
    name: p_name.value,
    price: Number(p_price.value),
    currency: p_currency.value,
    stock: Number(p_stock.value),
    images,
    category: currentCategory
  });

  localStorage.setItem("products", JSON.stringify(products));

  p_name.value="";
  p_price.value="";
  p_stock.value="";
  p_images.value="";

  renderProducts();
}

/* RENDER PRODUCTS */
function renderProducts(){
  productList.innerHTML="";
  products
    .filter(p=>p.category===currentCategory)
    .forEach((p,i)=>{
      productList.innerHTML+=`
        <div class="card">
          <b>${p.name}</b><br>
          Ø§Ù„Ø³Ø¹Ø±: ${p.price} ${p.currency}<br>
          Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${p.stock}<br>

          ${p.images.map(img=>`<img src="${img}">`).join("")}

          <button class="primary"
            ${p.stock<=0?"disabled":""}
            onclick="addToCart(${i})">
            ${p.stock<=0?"Ù†ÙØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†":"Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©"}
          </button>
        </div>
      `;
    });
}

/* CART */
function addToCart(index){
  if(products[index].stock<=0) return;

  products[index].stock--;
  cart.push({
    name:products[index].name,
    price:products[index].price,
    currency:products[index].currency
  });

  localStorage.setItem("products", JSON.stringify(products));
  localStorage.setItem("cart", JSON.stringify(cart));

  renderProducts();
  renderCart();
}

function renderCart(){
  cartItems.innerHTML="";
  let sum=0;
  cart.forEach((c,i)=>{
    sum+=c.price;
    cartItems.innerHTML+=`
      <div class="card">
        ${c.name} - ${c.price} ${c.currency}
        <button onclick="removeItem(${i})">âŒ</button>
      </div>
    `;
  });
  total.innerText="Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: "+sum;
}

function removeItem(i){
  cart.splice(i,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

renderCart();
</script>

</body>
</html>

