<!-- Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ø­Ù…ÙŠØ© Ø£Ùˆ Ø¨Ø¹Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
<div id="calorieSummary" class="result-box"></div>

<script>
// ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ
function updateCalorieSummary() {
  // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ù…Ù† Ø§Ù„Ø·Ø¹Ø§Ù…
  let totalFood = dietHistory.reduce((sum, e) => sum + e.calories, 0);

  // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø±ÙˆÙ‚Ø© Ù…Ù† Ø§Ù„Ø¬Ø±ÙŠ
  let totalBurned = runHistory.reduce((sum, e) => sum + e.calories, 0);

  let remaining = totalFood - totalBurned;

  let msg = `ğŸ½ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ù„ÙƒØ©: <b>${totalFood} Ø³Ø¹Ø± Ø­Ø±Ø§Ø±ÙŠ</b><br>
             ğŸƒ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø±ÙˆÙ‚Ø©: <b>${totalBurned} Ø³Ø¹Ø± Ø­Ø±Ø§Ø±ÙŠ</b><br>`;

  if(remaining > 0){
    msg += `âš  ØªØ­ØªØ§Ø¬ Ù„Ø­Ø±Ù‚ <b>${remaining} Ø³Ø¹Ø± Ø­Ø±Ø§Ø±ÙŠ</b> Ø¥Ø¶Ø§ÙÙŠØ© Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„ÙŠÙˆÙ….`;
  } else {
    msg += `âœ… Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù‡Ø¯ÙÙƒ Ø§Ù„ÙŠÙˆÙ… Ø£Ùˆ ØªØ¬Ø§ÙˆØ²ØªÙ‡!`;
  }

  document.getElementById("calorieSummary").innerHTML = msg;
}

// ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
function updateDiet() {
  let html = "", total = 0;
  dietHistory.forEach((e, index) => {
    html += `
      <p>
        ğŸ¥— ${e.meal}: <b>${e.calories} Ø³Ø¹Ø± Ø­Ø±Ø§Ø±ÙŠ</b> â€” ğŸ“… ${e.date}
        <button onclick="editMeal(${index})" style="margin-left:5px;">ØªØ¹Ø¯ÙŠÙ„</button>
        <button onclick="deleteMeal(${index})" style="margin-left:5px;">Ø­Ø°Ù</button>
      </p><hr>`;
    total += e.calories;
  });
  document.getElementById("dietBox").innerHTML = html;
  document.getElementById("totalCalories").innerHTML = `<b>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…: ${total} Ø³Ø¹Ø± Ø­Ø±Ø§Ø±ÙŠ</b>`;
  updateCalorieSummary();
}

function calculate() {
  if(!currentUser) return alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
  let age = Number(document.getElementById("age").value);
  let weight = Number(document.getElementById("weight").value);
  let height = Number(document.getElementById("height").value);
  let gender = document.getElementById("gender").value;
  let calories = Number(document.getElementById("cal").value);
  let speed = Number(document.getElementById("speed").value);
  if (!age || !weight || !height || !calories || !speed) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

  let pace = 60 / speed;
  let distance = calories / weight;
  let timeMinutes = (distance / speed) * 60;
  let vo2 = (speed * 3.5).toFixed(1);

  let entry = { distance: distance.toFixed(2), calories, speed, date: new Date().toLocaleString() };
  runHistory.push(entry);
  users[currentUser].runHistory = runHistory;
  localStorage.setItem("users", JSON.stringify(users));

  document.getElementById("result").innerHTML = `
    âœ” Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: <b>${distance.toFixed(2)} ÙƒÙ…</b><br>
    âœ” Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: <b>${timeMinutes.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</b><br>
    âœ” Ø§Ù„Ù€ Pace: <b>${pace.toFixed(2)} Ø¯Ù‚ÙŠÙ‚Ø©/ÙƒÙ…</b><br>
    âœ” VOâ‚‚ Max: <b>${vo2}</b><br>
    âœ” Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ù„ÙƒÙ„ ÙƒÙŠÙ„ÙˆÙ…ØªØ±: <b>${weight}</b>
  `;

  updateHistory();
  drawChart();
  updateCalorieSummary(); // ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¬Ø±ÙŠ
}
