<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>RUN FIT - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { margin: 0; font-family: "Cairo", sans-serif; direction: rtl; background: #f5f7fb; }
  .navbar { background: #0a7cff; padding: 18px 40px; color: white; display: flex; justify-content: space-between; font-size: 20px; font-weight: 700; }
  .navbar ul { display: flex; list-style: none; gap: 25px; }
  .navbar a { color: white; text-decoration: none; font-size: 18px; }
  .container { max-width: 700px; margin: 40px auto; background: white; padding: 30px; border-radius: 16px; box-shadow: 0 5px 18px rgba(0,0,0,0.12); }
  input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #bbb; margin: 8px 0; }
  button { width: 100%; padding: 15px; background: #0a7cff; color: white; border: none; border-radius: 12px; font-size: 18px; cursor: pointer; margin-top: 10px; }
  .result-box { margin-top: 20px; background: #e9f4ff; border-right: 6px solid #008cff; padding: 20px; border-radius: 12px; }
  .history-box { margin-top: 20px; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
  footer { margin-top: 50px; background: #0a7cff; color: white; padding: 20px; text-align: center; }
  .hidden { display: none; }
</style>
</head>
<body>

<nav class="navbar">
  <div>RUN FIT</div>
  <ul>
    <li><a href="#calcSection">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¬Ø±ÙŠ</a></li>
    <li><a href="#historySection">Ø§Ù„Ø³Ø¬Ù„</a></li>
    <li><a href="#dietSection">Ø§Ù„Ø­Ù…ÙŠØ©</a></li>
    <li><a href="#" id="logoutBtn" class="hidden">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
  </ul>
</nav>

<div class="container" id="authSection">
  <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
  <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
  <input type="email" id="email" />

  <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
  <input type="password" id="password" />

  <button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
  <button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>

  <div id="authMsg" class="result-box"></div>
</div>

<div class="container hidden" id="calcSection">
  <h2>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¬Ø±ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>
  <label>Ø§Ù„Ø¹Ù…Ø±:</label><input type="number" id="age" />
  <label>Ø§Ù„ÙˆØ²Ù† (ÙƒØº):</label><input type="number" id="weight" />
  <label>Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…):</label><input type="number" id="height" />

  <label>Ø§Ù„Ø¬Ù†Ø³:</label>
  <select id="gender">
    <option value="male">Ø°ÙƒØ±</option>
    <option value="female">Ø£Ù†Ø«Ù‰</option>
  </select>

  <label>Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¯ Ø­Ø±Ù‚Ù‡Ø§:</label><input type="number" id="cal" />
  <label>Ø³Ø±Ø¹Ø© Ø§Ù„Ø¬Ø±ÙŠ (ÙƒÙ…/Ø³Ø§Ø¹Ø©):</label><input type="number" id="speed" />
  <button onclick="calculate()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¢Ù†</button>

  <div id="result" class="result-box"></div>
</div>

<div class="container hidden" id="historySection">
  <h2>ğŸ“Œ Ø³Ø¬Ù„ ØªØ¯Ø±ÙŠØ¨Ø§ØªÙƒ</h2>
  <canvas id="chart" height="120"></canvas>
  <div id="historyBox" class="history-box"></div>
</div>

<div class="container hidden" id="dietSection">
  <h2>ğŸ¥— ØªØªØ¨Ø¹ Ø§Ù„Ø­Ù…ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>

  <label>Ø§Ø®ØªØ± Ø§Ù„ÙˆØ¬Ø¨Ø©:</label>
  <select id="mealSelect">
    <option value="Ø¨ÙŠØ¶ Ù…Ø³Ù„ÙˆÙ‚" data-cal="155">ğŸ¥š Ø¨ÙŠØ¶ Ù…Ø³Ù„ÙˆÙ‚ â€” 155 Ø³Ø¹Ø±Ø©</option>
    <option value="Ø´ÙˆÙØ§Ù†" data-cal="300">ğŸ¥£ Ø´ÙˆÙØ§Ù† â€” 300 Ø³Ø¹Ø±Ø©</option>
    <option value="Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ" data-cal="220">ğŸ— Ø¯Ø¬Ø§Ø¬ Ù…Ø´ÙˆÙŠ â€” 220 Ø³Ø¹Ø±Ø©</option>
    <option value="ØªÙˆÙ†Ø©" data-cal="180">ğŸŸ ØªÙˆÙ†Ø© â€” 180 Ø³Ø¹Ø±Ø©</option>
    <option value="Ø³Ù„Ø·Ø©" data-cal="90">ğŸ¥— Ø³Ù„Ø·Ø© â€” 90 Ø³Ø¹Ø±Ø©</option>
    <option value="Ø£Ø±Ø²" data-cal="210">ğŸš Ø£Ø±Ø² â€” 210 Ø³Ø¹Ø±Ø©</option>
    <option value="Ù…ÙˆØ²" data-cal="100">ğŸŒ Ù…ÙˆØ² â€” 100 Ø³Ø¹Ø±Ø©</option>
    <option value="Ø²Ø¨Ø§Ø¯ÙŠ" data-cal="120">ğŸ¥› Ø²Ø¨Ø§Ø¯ÙŠ â€” 120 Ø³Ø¹Ø±Ø©</option>
  </select>

  <button onclick="addMeal()">Ø£Ø¶Ù Ø§Ù„ÙˆØ¬Ø¨Ø©</button>

  <div id="dietBox" class="history-box"></div>
  <div id="totalCalories" class="result-box"></div>
</div>

<footer>Â© 2025 RUN FIT â€” Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</footer>

<script>
let currentUser = localStorage.getItem("currentUser") || null;
let users = JSON.parse(localStorage.getItem("users") || "{}");
let runHistory = [];
let dietHistory = [];
let chart;

function register() {
  let email = email.value.trim();
  let password = password.value.trim();
  if (!email || !password) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");
  if (users[email]) return alert("Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„");
  users[email] = { password, runHistory: [], dietHistory: [] };
  localStorage.setItem("users", JSON.stringify(users));
  alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.");
}

function login() {
  let emailV = email.value.trim();
  let passV = password.value.trim();
  if (users[emailV] && users[emailV].password === passV) {
    currentUser = emailV;
    localStorage.setItem("currentUser", currentUser);
    showApp();
  } else alert("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„");
}

document.getElementById("logoutBtn").addEventListener("click", () => {
  currentUser = null;
  localStorage.removeItem("currentUser");
  authSection.classList.remove("hidden");
  calcSection.classList.add("hidden");
  historySection.classList.add("hidden");
  dietSection.classList.add("hidden");
  logoutBtn.classList.add("hidden");
});

function showApp() {
  authSection.classList.add("hidden");
  calcSection.classList.remove("hidden");
  historySection.classList.remove("hidden");
  dietSection.classList.remove("hidden");
  logoutBtn.classList.remove("hidden");

  runHistory = users[currentUser].runHistory || [];
  dietHistory = users[currentUser].dietHistory || [];
  updateHistory();
  drawChart();
  updateDiet();
}

function calculate() {
  if (!currentUser) return alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
  let ageV = Number(age.value);
  let weightV = Number(weight.value);
  let heightV = Number(height.value);
  let calV = Number(cal.value);
  let speedV = Number(speed.value);
  if (!ageV || !weightV || !heightV || !calV || !speedV) return alert("Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

  let distance = calV / weightV;
  let timeMinutes = (distance / speedV) * 60;
  let pace = 60 / speedV;
  let vo2 = (speedV * 3.5).toFixed(1);

  let entry = { distance: distance.toFixed(2), calories: calV, speed: speedV, date: new Date().toLocaleString() };
  runHistory.push(entry);
  users[currentUser].runHistory = runHistory;
  localStorage.setItem("users", JSON.stringify(users));

  result.innerHTML =
    `âœ” Ø§Ù„Ù…Ø³Ø§ÙØ©: <b>${distance.toFixed(2)} ÙƒÙ…</b><br>
     âœ” Ø§Ù„Ø²Ù…Ù†: <b>${timeMinutes.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</b><br>
     âœ” Ø§Ù„Ù€ Pace: <b>${pace.toFixed(2)}</b><br>
     âœ” VOâ‚‚ Max: <b>${vo2}</b>`;

  updateHistory();
  drawChart();
}

function updateHistory() {
  let html = "";
  runHistory.forEach(e => {
    html += `<p>ğŸƒ Ù…Ø³Ø§ÙØ©: <b>${e.distance} ÙƒÙ…</b> â€” ğŸ”¥ <b>${e.calories}</b> â€” âš¡ <b>${e.speed}</b> â€” ğŸ“… ${e.date}</p><hr>`;
  });
  historyBox.innerHTML = html;
}

function drawChart() {
  let ctx = chart;
  if (chart) chart.destroy();
  chart = new Chart(ctx, {
    type: "line",
    data: {
      labels: runHistory.map(e => e.date),
      datasets: [{ label: "Ø§Ù„Ù…Ø³Ø§ÙØ© (ÙƒÙ…)", data: runHistory.map(e => e.distance), borderWidth: 3 }]
    },
    options: { scales: { y: { beginAtZero: true } } }
  });
}

function addMeal() {
  let select = document.getElementById("mealSelect");
  let meal = select.value;
  let calories = Number(select.selectedOptions[0].getAttribute("data-cal"));

  let entry = { meal, calories, date: new Date().toLocaleString() };
  dietHistory.push(entry);
  users[currentUser].dietHistory = dietHistory;
  localStorage.setItem("users", JSON.stringify(users));
  updateDiet();
}

function updateDiet() {
  let html = "", total = 0;
  dietHistory.forEach(e => {
    html += `<p>ğŸ¥— ${e.meal}: <b>${e.calories} Ø³Ø¹Ø±Ø©</b> â€” ğŸ“… ${e.date}</p><hr>`;
    total += e.calories;
  });
  dietBox.innerHTML = html;
  totalCalories.innerHTML = `<b>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙŠÙˆÙ…: ${total} Ø³Ø¹Ø±Ø©</b>`;
}

if (currentUser) showApp();
</script>
</body>
</html>
